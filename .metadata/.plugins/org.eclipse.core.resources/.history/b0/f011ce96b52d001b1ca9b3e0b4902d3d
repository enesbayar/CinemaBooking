package Gui;

import java.awt.BorderLayout;
import java.awt.EventQueue;

import javax.swing.JFrame;
import javax.swing.JOptionPane;
import javax.swing.JPanel;
import javax.swing.border.EmptyBorder;
import javax.swing.JLabel;
import javax.swing.SwingConstants;

import java.awt.Font;

import javax.swing.JButton;

import Model.Movie;
import Services.MovieServices;

import java.awt.Color;
import java.util.ArrayList;
import java.awt.event.ActionListener;
import java.awt.event.ActionEvent;

public class TicketInfoScreen extends JFrame {

	private JPanel optionPane;
	private Movie movie;
	private int selectedSeatCount;
	private String[] splittedSeats;
	public String newSeats;
	private MovieServices movieServices;
	private boolean result;
	/**
	 * Launch the application.
	 */
	public static void main(String[] args) {
		EventQueue.invokeLater(new Runnable() {
			public void run() {
				try {
					//TicketInfoScreen frame = new TicketInfoScreen();
					//frame.setVisible(true);
				} catch (Exception e) {
					e.printStackTrace();
				}
			}
		});
	}

	/**
	 * Create the frame.
	 */
	public TicketInfoScreen(Movie movie, int selectedSeatCount, String[] splittedSeats) {
		setResizable(false);
		this.movie = movie;
		this.selectedSeatCount = selectedSeatCount;
		this.splittedSeats = splittedSeats;
		movieServices = new MovieServices();
		newSeats = new String("");
		for(int i = 0; i< splittedSeats.length; i++){
			if(i!=33){
				newSeats += splittedSeats[i] + ";"; 
			}
			else{
				newSeats += splittedSeats[i];
			}
		}
		System.out.println("New Seats " + newSeats);
		setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
		setBounds(100, 100, 450, 300);
		optionPane = new JPanel();
		optionPane.setBorder(new EmptyBorder(5, 5, 5, 5));
		setContentPane(optionPane);
		optionPane.setLayout(null);
		
		JLabel lblCinemaName = new JLabel("SineMovie");
		lblCinemaName.setBounds(5, 5, 424, 19);
		lblCinemaName.setFont(new Font("Georgia", Font.BOLD, 16));
		lblCinemaName.setHorizontalAlignment(SwingConstants.CENTER);
		optionPane.add(lblCinemaName);
		
		JLabel lblMovieName = new JLabel("Film Ad\u0131              : " + movie.getMovieName());
		lblMovieName.setBounds(15, 44, 276, 25);
		lblMovieName.setFont(new Font("Cambria Math", Font.BOLD, 12));
		lblMovieName.setVerticalAlignment(SwingConstants.TOP);
		lblMovieName.setHorizontalAlignment(SwingConstants.LEFT);
		optionPane.add(lblMovieName);
		
		JLabel lblMovieSession = new JLabel("Seans                  : " + movie.getSessions());
		lblMovieSession.setVerticalAlignment(SwingConstants.TOP);
		lblMovieSession.setHorizontalAlignment(SwingConstants.LEFT);
		lblMovieSession.setFont(new Font("Cambria Math", Font.BOLD, 12));
		lblMovieSession.setBounds(15, 80, 276, 25);
		optionPane.add(lblMovieSession);
		
		JLabel lblMovieDate = new JLabel("Tarih                   : ");
		lblMovieDate.setVerticalAlignment(SwingConstants.TOP);
		lblMovieDate.setHorizontalAlignment(SwingConstants.LEFT);
		lblMovieDate.setFont(new Font("Cambria Math", Font.BOLD, 12));
		lblMovieDate.setBounds(15, 116, 276, 25);
		optionPane.add(lblMovieDate);
		
		JLabel lblSeilenKoltukSays = new JLabel("Koltuk Say\u0131s\u0131        : ");
		lblSeilenKoltukSays.setVerticalAlignment(SwingConstants.TOP);
		lblSeilenKoltukSays.setHorizontalAlignment(SwingConstants.LEFT);
		lblSeilenKoltukSays.setFont(new Font("Cambria Math", Font.BOLD, 12));
		lblSeilenKoltukSays.setBounds(15, 152, 276, 25);
		optionPane.add(lblSeilenKoltukSays);
		
		JLabel lbldenecekTutar = new JLabel("\u00D6denecek Tutar    : " + String.valueOf((movie.getPrice()*selectedSeatCount)));
		lbldenecekTutar.setVerticalAlignment(SwingConstants.TOP);
		lbldenecekTutar.setHorizontalAlignment(SwingConstants.LEFT);
		lbldenecekTutar.setFont(new Font("Cambria Math", Font.BOLD, 12));
		lbldenecekTutar.setBounds(15, 192, 276, 25);
		optionPane.add(lbldenecekTutar);
		
		JButton btnApprove = new JButton("Onayla");
		btnApprove.setFont(new Font("Georgia", Font.BOLD, 10));
		btnApprove.setBounds(172, 225, 98, 25);
		optionPane.add(btnApprove);
		btnApprove.addActionListener(new ActionListener() {
			public void actionPerformed(ActionEvent arg0) {
				
				result = movieServices.updateSeats(newSeats, movie.getMovieName());
				if(result){
					JOptionPane.showMessageDialog(null, "Biletiniz Onaylandý!");
				}
				else{
					JOptionPane.showMessageDialog(null, "Hata Oluþtu!");
				}
				newSeats = "";
			}
		});
		
	}
}
